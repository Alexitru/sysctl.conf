# Enable IP forwarding
net.ipv4.ip_forward = 1

# Enable source address verification
net.ipv4.conf.all.rp_filter = 1

# Enable SYN flood protection
net.ipv4.tcp_syncookies = 1

# Enable TCP SYN cookies
net.ipv4.tcp_syncookies = 1

# Enable TCP SYN retransmits
net.ipv4.tcp_synack_retries = 2

# Enable TCP packet timestamps
net.ipv4.tcp_timestamps = 1

# Enable TCP selective acknowledgements
net.ipv4.tcp_sack = 1

# Enable TCP window scaling
net.ipv4.tcp_window_scaling = 1

# Enable TCP fast open
net.ipv4.tcp_fastopen = 3

# Enable TCP no delay
net.ipv4.tcp_nodelay = 1

# Enable TCP congestion control
net.ipv4.tcp_congestion_control = htcp

# Enable TCP low latency
net.ipv4.tcp_low_latency = 1

# Enable ICMP redirects
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0

# Enable ICMP rate limiting
net.ipv4.icmp_ratelimit = 100
net.ipv4.icmp_ratelimit_burst = 100

# Enable TCP rate limiting
net.ipv4.tcp_rmem = 4096 87380 33554432
net.ipv4.tcp_wmem = 4096 65536 33554432
net.ipv4.tcp_max_syn_backlog = 65536

# Enable UDP rate limiting
net.ipv4.udp_mem = 65536 131072 262144
net.ipv4.udp_rmem_min = 8192

# Enable IP protocol filtering
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.all.rp_filter = 1

# Enable IP fragment filtering
net.ipv4.ipfrag_low_thresh = 196608
net.ipv4.ipfrag_high_thresh = 262144

# Enable ICMP filtering
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.icmp_echo_ignore_all = 1

# Enable IGMP rate limiting
net.ipv4.igmp_max_memberships = 20
net.ipv4.igmp_max_msf = 10
